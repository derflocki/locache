(function(){function b(a){a&&a.storage&&(this.storage=a.storage);this.async.set=k(this.async.set,this);this.async.get=k(this.async.get,this)}var c=this;c.Promise||console.log("Promise isn't available at this browser");var k=function(a,d){return function(){return a.apply(d,arguments)}};b.prototype.VERSION="0.4.4";var g=b.prototype,h;try{c.localStorage.setItem("___locache___","___locache___"),c.localStorage.getItem("___locache___"),c.localStorage.removeItem("___locache___"),h=!0}catch(q){h=!1}var n=
g.supportsLocalStorage=h,g=b.prototype,f;try{c.sessionStorage.setItem("___locache___","___locache___"),c.sessionStorage.getItem("___locache___"),c.sessionStorage.removeItem("___locache___"),f=!0}catch(r){f=!1}var p=g.supportsSessionStorage=f,l=b.prototype.supportsNativeJSON=!!c.JSON;b.prototype.supportsPostMessage=!!c.postMessage;b.prototype.cachePrefix="___locache___";b.prototype.expirePrefix="___locacheExpire___";b.prototype.backends={local:{set:function(a,d){return c.localStorage.setItem(a,d)},
get:function(a){return c.localStorage.getItem(a)},remove:function(a){return c.localStorage.removeItem(a)},length:function(a){return c.localStorage.length},key:function(a){if(!(0>a||a>=this.length()))return c.localStorage.key(a)},enabled:function(){return l&&n}},session:{set:function(a,d){return c.sessionStorage.setItem(a,d)},get:function(a){return c.sessionStorage.getItem(a)},remove:function(a){return c.sessionStorage.removeItem(a)},length:function(a){return c.sessionStorage.length},key:function(a){if(!(0>
a||a>=this.length()))return c.sessionStorage.key(a)},enabled:function(){return l&&p}}};b.prototype.storage=b.prototype.backends.local;b.prototype.key=function(a){return this.cachePrefix+a};b.prototype.expirekey=function(a){return this.expirePrefix+a};b.prototype.hasExpired=function(a){a=this.expirekey(a);return(a=parseInt(this.storage.get(a),10))&&a<(new Date).getTime()?!0:!1};b.prototype.set=function(a,d,m){if(this.storage.enabled()&&a){var b=this.expirekey(a);a=this.key(a);m?this.storage.set(b,
(new Date).getTime()+1E3*m):this.storage.remove(b);d=JSON.stringify(d);return this.storage.set(a,d)}};b.prototype.get=function(a){if(!this.storage.enabled()||!a)return null;if(this.hasExpired(a))return this.remove(this.key(a)),null;a=this.key(a);if(a=this.storage.get(a))try{return JSON.parse(a)}catch(d){return null}return a};b.prototype.async={set:function(a,d,b){return Promise.resolve(this.set(a,d,b))},get:function(a){return Promise.resolve(this.get(a))}};b.prototype.remove=function(a){if(this.storage.enabled()){var d=
this.expirekey(a);a=this.key(a);this.storage.remove(d);this.storage.remove(a)}};b.prototype.incr=function(a){if(this.storage.enabled()){var d=parseInt(this.get(a),10);d||(d=0);d++;this.set(a,d);return d}};b.prototype.decr=function(a){if(this.storage.enabled()){var d=parseInt(this.get(a),10);d||(d=0);d--;this.set(a,d);return d}};b.prototype.setMany=function(a,d){if(this.storage.enabled())for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b],d)};b.prototype.getMany=function(a){for(var d={},b=0;b<a.length;b++)this.storage.enabled()?
d[a[b]]=this.get(a[b]):d[a[b]]=null;return d};b.prototype.getManyValues=function(a){for(var d=[],b=0;b<a.length;b++)this.storage.enabled()?d.push(this.get(a[b])):d.push(null);return d};b.prototype.removeMany=function(a){if(this.storage.enabled())for(var b=0;b<a.length;b++)this.remove(a[b])};b.prototype.flush=function(){if(this.storage.enabled())for(var a=this.storage.length(),b=this.cachePrefix,a=a-1;0<=a;a--){var c=this.storage.key(a);c&&0===c.indexOf(b)&&(c=c.substring(b.length,c.length),this.remove(c))}};
b.prototype.length=function(){if(!this.storage.enabled())return 0;for(var a=0,b=this.storage.length(),c=this.cachePrefix,e=0;e<b;e++)0===this.storage.key(e).indexOf(c)&&a++;return a};b.prototype.keys=function(){if(!this.storage.enabled())return[];for(var a=[],b=this.storage.length(),c=this.cachePrefix,e=0;e<b;e++){var f=this.storage.key(e);0===f.indexOf(c)&&(f=f.substring(c.length,f.length),a.push(f))}return a};b.prototype.cleanup=function(){if(this.storage.enabled())for(var a=this.storage.length(),
b=this.cachePrefix,c=0;c<a;c++){var e=this.storage.key(c);e&&0===e.indexOf(b)&&(e=e.substring(b.length,e.length),this.hasExpired(e)&&this.remove(e))}};b.prototype.createCache=function(a){return new b(a)};f=new b;f.session=new b({storage:f.backends.session});c.locache=f}).call(this);
